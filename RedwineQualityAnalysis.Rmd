---
title: "RedwineAnalysis"
author: "Suchismitha Vedala"
date: "6/16/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Project Description

This is a red wine data analysis project. In this project, we analyse what chemical feature impacts the quality of the red wine.

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
library(ggcorrplot)
library(ggplot2)
library(scales)
library(gridExtra)
library(GGally)
```

```{r echo=FALSE, Load_the_Data}
dir=getwd()
setwd(dir)
data=read.csv("wineQualityReds.csv")
#function to plot mean point
give.n <- function(x){
  return(data.frame(y = max(x)+1,
                    label = paste0("n = ",length(x))))
}

```
#Peforming Initial Data Analysis
```{r echo=FALSE, Initial_data_Analysis}
data=data[,-1]

#Names of the aspects in the data set
names(data)
c=colnames(data)
#Getting dimensions of data
dim(data)
```
The data has 1599 rows and 12 columns

The structure of the data is as follows:
```{r echo=FALSE}
str(data)
```
The summary statistics of the data are as follows:
```{r echo=FALSE}
summary(data)
attach(data)
```
We observe that there are 11 characteristics which effect the quality. We will perform analysis to 
# Univariate Plots Section
```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(data$quality)
ggplot(data, aes(x = factor(data$quality))) + geom_bar()+labs(x = 'Quality', y = 'Number of observations')+ggtitle("Quality Analysis")
summary(data$pH)
ggplot(data, aes(x = (data$pH))) + geom_bar()+labs(x = 'pH', y = 'Number of observations')+ggtitle("pH Analysis")
summary(data$fixed.acidity)
ggplot(data, aes(x = (data$fixed.acidity))) + geom_bar()+labs(x = 'Fixed Acidity', y = 'Number of observations')+ggtitle("Fixed Acidity Analysis")
summary(data$volatile.acidity)
ggplot(data, aes(x = (data$volatile.acidity))) + geom_bar()+labs(x = 'Volatile Acidity', y = 'Number of observations')+ggtitle("Volatile Acidity Analysis")
ggplot(data, aes(x = (data$volatile.acidity))) + geom_bar()+xlim(0.1,1)+labs(x = 'Volatile Acidity', y = 'Number of observations')+ggtitle("Volatile Acidity Analysis")
summary(data$citric.acid)
ggplot(data, aes(x = (data$citric.acid))) + geom_bar()+labs(x = 'Citric Acid', y = 'Number of observations')+ggtitle("Citric Acid Analysis")
summary(data$density)
ggplot(data, aes(x = (data$density))) + stat_count(width=0.0005)+labs(x = 'density', y = 'Number of observations')+ggtitle("Density Analysis")
summary(data$chlorides)
ggplot(data, aes(x = (data$chlorides))) + stat_count(width=0.005)+labs(x = 'Chlorides', y = 'Number of observations')+ggtitle("Chlorides Analysis")
ggplot(data, aes(x = (data$chlorides))) + stat_count(width=0.005)+xlim(0.05,0.25)+labs(x = 'Chlorides', y = 'Number of observations')+ggtitle("Chlorides Analysis")
summary(data$residual.sugar)
ggplot(data, aes(x = (data$residual.sugar))) + stat_count(width=0.5)+labs(x = 'Residual Sugar', y = 'Number of observations')+ggtitle("Residual Sugar Analysis")
ggplot(data, aes(x = (data$residual.sugar))) + stat_count(width=0.5)+xlim(1,7.5)+labs(x = 'Residual Sugar', y = 'Number of observations')+ggtitle("Residual Sugar Analysis")
summary(data$free.sulfur.dioxide)
ggplot(data, aes(x = (data$free.sulfur.dioxide))) + stat_count(width=1)+labs(x = 'Free sulphur dioxide', y = 'Number of observations')+ggtitle("Free sulphur dioxideAnalysis")
ggplot(data, aes(x = (data$free.sulfur.dioxide))) + xlim(0,50)+stat_count(width=1)+labs(x = 'Free sulphur dioxide', y = 'Number of observations')+ggtitle("Free sulphur dioxideAnalysis")
summary(data$total.sulfur.dioxide)
ggplot(data, aes(x = (data$total.sulfur.dioxide))) + stat_count(width=1)+labs(x = 'Total sulphur dioxide', y = 'Number of observations')+ggtitle("Total sulphur dioxide Analysis")
ggplot(data, aes(x = (data$total.sulfur.dioxide))) + stat_count(width=1)+xlim(0,150)+labs(x = 'Total sulphur dioxide', y = 'Number of observations')+ggtitle("Total sulphur dioxide Analysis")
summary(data$sulphates)
ggplot(data, aes(x = (data$sulphates))) + stat_count(width=0.05)+labs(x = 'Sulphates', y = 'Number of observations')+ggtitle("Sulphates Analysis")
ggplot(data, aes(x = (data$sulphates))) + stat_count(width=0.05)+xlim(0.25,1.5)+labs(x = 'Sulphates', y = 'Number of observations')+ggtitle("Sulphates Analysis")
summary(data$alcohol)
ggplot(data, aes(x = (data$alcohol))) + stat_count(width=0.5)+labs(x = 'Alcohol', y = 'Number of observations')+ggtitle("Alcohol Analysis")
```


# Univariate Analysis

After performing initial and univariate analysis, now we answer some of the important questions that gives an idea of the data and helps us  make further analys

### What is the structure of your dataset?
The data consists of 1599 observations and 12 characteristics. 11 characteristic fearures and 1 impacting feauture Quality.

### What is/are the main feature(s) of interest in your dataset?
Quality is of main interest in the data. And also all the other 11 characters.
### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?
Most of the observations have:
1.Quality of 5,6. Very minimum observations are seen with quality 3,7,8.
2.Average pH is over 3 and 3.5
3.Alcohol value between 9 and 11
4.very less citric acid, density, chlorides and sulphates value.

### Did you create any new variables from existing variables in the dataset?
No.

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?
Volatile acid, chlorides,citric acid residual sugar, total sulpher dioxide, sulphates have very minimal observations as the value increases.
X limits on these plots have been adjusted for better understanding.and visualization.

# Bivariate Plots Section

Let us look at the correlation statistics
```{r echo=FALSE, message=FALSE, warning=FALSE}
cor(data)
```
Let's examine the correlation matrix with the correlative value. We know that the correlation values range from -1 to 1, with value towards 1 are positively correlated and towards -1 is negatively correlated
```{r echo=FALSE, message=FALSE, warning=FALSE}
ggcorrplot(cor(data),lab = TRUE)
```

Let us draw the correlation pairs figure and observe the graphs
```{r echo=FALSE, message=FALSE, warning=FALSE}
ggpairs(data,columns = 1:12)+theme_light()+theme(panel.grid.major = element_line(colour = 'transparent'))

```

When we see how quality is correlated with others, we observe the following:
```{r echo=FALSE, message=FALSE, warning=FALSE}
cor(data$quality,data)
```


We see that quality is positive correlated with alcohol,fixed acidity citric acid, residual sugar and sulphates and negatively correlated with volatile acidity, chlorides, free sulphur dioxide, total sulphur dioxide, desnity and pH.
```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data, aes(x=factor(quality), y=data$fixed.acidity,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on Fixed Axidity") +labs(x="Quality",y="Fixed Acidity")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data, aes(x=factor(quality), y=data$volatile.acidity,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on Volatile Acidity") +labs(x="Quality",y="Volatile Acidity")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data, aes(x=factor(quality), y=data$citric.acid,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on Citric Acid") +labs(x="Quality",y="Citric Acid ")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data, aes(x=factor(quality), y=data$residual.sugar,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on Residual Sugar") +labs(x="Quality",y="Residual Sugar")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data, aes(x=factor(quality), y=data$chlorides,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on Chlorides") +labs(x="Quality",y="chlorides ")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data, aes(x=factor(quality), y=data$sulphates,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on Sulphates") +labs(x="Quality",y="Sulphates")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data, aes(x=factor(quality), y=data$density,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on Density") +labs(x="Quality",y="Density")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data, aes(x=factor(quality), y=data$alcohol,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on Alcohol") +labs(x="Quality",y="Alcohol")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data, aes(x=factor(quality), y=data$free.sulfur.dioxide,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on Free sulphur dioxide") +labs(x="Quality",y="Free sulphur dioxide")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data, aes(x=factor(quality), y=data$total.sulfur.dioxide,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on total sulphur dioxide") +labs(x="Quality",y="Total Sulphur dioxide")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data, aes(x=factor(quality), y=data$pH,fill=quality))  +theme_light()+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality based on pH") +labs(x="Quality",y="pH")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")+theme(panel.grid.major = element_line(colour = 'transparent'))
```

Let us explore other correlations.

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data,aes(data$fixed.acidity, data$citric.acid))+ 
  geom_jitter(alpha=0.2) +geom_smooth(method=lm)+theme_light()+theme(plot.title = element_text(hjust = 0.5))+
  labs(x = 'Fixed acidity', y = 'Citric Acid')+ggtitle("Effect of Citric Acidity on Fixed Acidity")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data,aes(data$fixed.acidity, data$pH))+ 
  geom_jitter(alpha=0.2) +geom_smooth(method=lm)+theme_light()+theme(plot.title = element_text(hjust = 0.5))+
  labs(x = 'Fixed acidity', y = 'pH')+ggtitle("Effect of Fixed Acidity on pH ")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data,aes(data$fixed.acidity, data$density))+ 
  geom_jitter(alpha=0.2) +geom_smooth(method=lm)+theme_light()+theme(plot.title = element_text(hjust = 0.5))+
  labs(x = 'Fixed acidity', y = 'density')+ggtitle("Effect of Fixed Acidity on density ")+theme(panel.grid.major = element_line(colour = 'transparent'))
ggplot(data,aes(data$free.sulfur.dioxide, data$total.sulfur.dioxide))+ 
  geom_jitter(alpha=0.2) +geom_smooth(method=lm)+theme_light()+theme(plot.title = element_text(hjust = 0.5))+
  labs(x = 'Free suplher dioxide', y = 'Total suplher dioxide')+ggtitle("Effect of Free suplher dioxide on Total suplher dioxide")+theme(panel.grid.major = element_line(colour = 'transparent'))

```

# Bivariate Analysis
We have now observed the correlation and impact of other factors on quality.

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

We observe that Quality has:
1.significant positive correlation with Fixed Acidity, Citric Acid,Sulphates and Alcohol
2.No significant positive or negative relation with density and residual sugar.
3.Significant negative correlation with chlorides and volatile acidity

### Did you observe any interesting relationships between the other features \(not the main feature(s) of interest)?

Density and citric acidity increase with fixed acidity whole pH decreases.
Total Sulphur dioxide and free sulphur dioxide are linearly positive.

### What was the strongest relationship you found?

Quality increases with citric acid and decreases with volatile acidity

# Multivariate Plots Section
```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data,aes(pH,alcohol,fill=factor(quality))) +theme(plot.title = element_text(hjust = 0.5)) + geom_bar(stat="identity")+ggtitle("Effect of ph and alcohol over quality")
ggplot(data,aes(volatile.acidity,fixed.acidity,fill=factor(quality))) +theme(plot.title = element_text(hjust = 0.5)) + geom_jitter(alpha=0.05) +geom_smooth(method=lm)+ggtitle("Effect of fixed acidity and volatile acidity over quality")
ggplot(data,aes(citric.acid,fixed.acidity,fill=factor(quality))) +theme(plot.title = element_text(hjust = 0.5)) + geom_jitter(alpha=0.05) +geom_smooth(method=lm)+ggtitle("Effect of citric acidity and fixed acidity over quality")
ggplot(data,aes(free.sulfur.dioxide,total.sulfur.dioxide,fill=factor(quality)))+theme(plot.title = element_text(hjust = 0.5)) + geom_point(alpha=0.05) +geom_smooth(method=lm)+ylim(0,200)+ggtitle("Effect of free sulphu dioxide and total sulphur dioxide over quality")
ggplot(data,aes(pH,density,fill=factor(quality))) +theme(plot.title = element_text(hjust = 0.5)) + geom_bar(stat="identity")+ggtitle("Effect of ph and density over quality")
ggplot(data,aes(citric.acid,volatile.acidity,fill=factor(quality))) +theme(plot.title = element_text(hjust = 0.5)) + geom_jitter(alpha=0.05) +geom_smooth(method=lm)+ggtitle("Effect of citri acidity and volatile acidity over quality")
ggplot(data,aes(alcohol,density,fill=factor(quality))) +theme(plot.title = element_text(hjust = 0.5)) + geom_jitter(alpha=0.05) +geom_smooth(method=lm)+ggtitle("Effect of density  and volatile alcohol over quality")
```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \investigation. Were there features that strengthened each other in terms of \looking at your feature(s) of interest?

With increase in free and total sulphur dioxe, quality increases.
Quality decreases with increase in volatile acidity and fixed acidity
Citric acidity increases with fixed acidity and so does quality

### Were there any interesting or surprising interactions between features?

Volatile acidity decreases with increase in cirtic acidity as well as  fixed acidity.
Most of the high quality observations have density below 20.


# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One,message=FALSE, warning=FALSE}
ggplot(data,aes(alcohol,density,fill=factor(quality))) +theme(plot.title = element_text(hjust = 0.5)) + geom_jitter(alpha=0.05,aes(color=factor(quality))) +ggtitle("Effect of density  and  alcohol over quality")
```

### Description One
We see that high alcohol and low density gives good alcohol quality.
### Plot Two
```{r echo=FALSE, Plot_Two,message=FALSE, warning=FALSE}
ggplot(data,aes(free.sulfur.dioxide,total.sulfur.dioxide,fill=factor(quality)))+theme(plot.title = element_text(hjust = 0.5)) + geom_point(alpha=0.05,aes(color=factor(quality))) +xlim(0,50)+ylim(0,200)+ggtitle("Effect of free sulphu dioxide and total sulphur dioxide over quality")

```
### Description Two

From above we see that as total and free  sulphur dioxide increaseand quality increases, but low quantities of each gives good quality.

### Plot Three
```{r echo=FALSE, Plot_Three,message=FALSE, warning=FALSE}
ggplot(data, aes(x=factor(quality), y=data$alcohol,fill=quality))+theme(plot.title = element_text(hjust = 0.5)) +  geom_boxplot()+ggtitle("Analysis of Quality on Alcohol") +labs(x="Quality",y="Alcohol")+stat_summary(fun.y="mean", geom="point", size=1, pch=16, color="red") +stat_summary(fun.data = give.n, geom = "text")
```
### Description Three

We see that increase in alcohol increases quality. 
------

# Reflection
Some analysis has been done to understand the impacting features on redwine dataquality.
We understand how some features alone do not effect the quality. It is important to do a complete analysis before coming to conclusions. Some of the interesting findings made through our analysis:
1.More than 60% of data have avergae quality 
2.Free and total sulphur dioxide increase parallelly but lower quantities of these ensure good quality.
3.High alcohol rate and low density increases quality.
 
###What were some of the struggles that you went through?What went well? What was surprising? Make sure you include an insight intofuture work that could be done with the dataset
I Struggled to understand the data set and analysis what plots can make better visualization.
Although initially I faced difficulty, analysis went easy once  started working.
Suprising is how most of the observations have average quality value and how it decreases with density.
Statistical tests and analysis can be done to proove the analysis mathematically.

